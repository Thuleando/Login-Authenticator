<?xml version = '1.0' encoding = 'UTF-8'?>
<StoredProcedureOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.StoredProcedureOraclev10g" name="CreateAccount_SP" directorySegmentName="seg_0" id="4007E857-682A-0808-CE41-D8E6AF5682F6">
<createdBy>Jason</createdBy>
<createdTime>2014-11-18 23:43:12 UTC</createdTime>
<ownerDesignName>Login_Authenticator2</ownerDesignName>
<source>create or replace PROCEDURE CreateAccount_SP &lt;br/&gt;(&lt;br/&gt;  USERNAME_IN IN VARCHAR2, &lt;br/&gt;  PASSWORD_IN IN VARCHAR2,&lt;br/&gt;  RESULT      OUT NUMBER &lt;br/&gt;) &lt;br/&gt;AS &lt;br/&gt;ValidUN         Accounts.USERNAME%TYPE;&lt;br/&gt;AccID           Accounts.ID%TYPE;&lt;br/&gt;ACCOUNT_EXISTS  Exception;&lt;br/&gt;&lt;br/&gt;BEGIN&lt;br/&gt;  &lt;&lt;Check_Account_Exists&gt;&gt;&lt;br/&gt;  BEGIN&lt;br/&gt;    SELECT Accounts.UserName INTO ValidUN FROM Accounts &lt;br/&gt;                WHERE UserName = USERNAME_IN;&lt;br/&gt;    Exception&lt;br/&gt;      WHEN NO_DATA_FOUND THEN&lt;br/&gt;        -- DBMS_OUTPUT.PUT_LINE(&apos;No Account found&apos;);&lt;br/&gt;        ValidUN := null;&lt;br/&gt;  END Check_Account_Exists;&lt;br/&gt;  &lt;br/&gt;  IF ValidUN is not null THEN&lt;br/&gt;       --DBMS_OUTPUT.PUT_LINE(&apos;If is true&apos;);&lt;br/&gt;    RAISE ACCOUNT_EXISTS;&lt;br/&gt;  END IF;&lt;br/&gt;&lt;br/&gt;  --DBMS_OUTPUT.PUT_LINE(validUN);&lt;br/&gt;  INSERT INTO Accounts (Username, PWord) VALUES(USERNAME_IN, PASSWORD_IN);&lt;br/&gt;  COMMIT;&lt;br/&gt;  SELECT Accounts.ID INTO AccID FROM Accounts &lt;br/&gt;                WHERE UserName = USERNAME_IN;&lt;br/&gt;  INSERT INTO LockEvents (Accounts_ID) VALUES(AccID);&lt;br/&gt;  RESULT := 1;&lt;br/&gt;&lt;br/&gt;  Exception&lt;br/&gt;  WHEN ACCOUNT_EXISTS THEN&lt;br/&gt;    RESULT := 2;&lt;br/&gt;  WHEN OTHERS THEN&lt;br/&gt;    RESULT := 3;&lt;br/&gt;  NULL;&lt;br/&gt;END CREATEACCOUNT_SP;</source>
<body>create or replace PROCEDURE CreateAccount_SP &lt;br/&gt;(&lt;br/&gt;  USERNAME_IN IN VARCHAR2, &lt;br/&gt;  PASSWORD_IN IN VARCHAR2,&lt;br/&gt;  RESULT      OUT NUMBER &lt;br/&gt;) &lt;br/&gt;AS &lt;br/&gt;ValidUN         Accounts.USERNAME%TYPE;&lt;br/&gt;AccID           Accounts.ID%TYPE;&lt;br/&gt;ACCOUNT_EXISTS  Exception;&lt;br/&gt;&lt;br/&gt;BEGIN&lt;br/&gt;  &lt;&lt;Check_Account_Exists&gt;&gt;&lt;br/&gt;  BEGIN&lt;br/&gt;    SELECT Accounts.UserName INTO ValidUN FROM Accounts &lt;br/&gt;                WHERE UserName = USERNAME_IN;&lt;br/&gt;    Exception&lt;br/&gt;      WHEN NO_DATA_FOUND THEN&lt;br/&gt;        -- DBMS_OUTPUT.PUT_LINE(&apos;No Account found&apos;);&lt;br/&gt;        ValidUN := null;&lt;br/&gt;  END Check_Account_Exists;&lt;br/&gt;  &lt;br/&gt;  IF ValidUN is not null THEN&lt;br/&gt;       --DBMS_OUTPUT.PUT_LINE(&apos;If is true&apos;);&lt;br/&gt;    RAISE ACCOUNT_EXISTS;&lt;br/&gt;  END IF;&lt;br/&gt;&lt;br/&gt;  --DBMS_OUTPUT.PUT_LINE(validUN);&lt;br/&gt;  INSERT INTO Accounts (Username, PWord) VALUES(USERNAME_IN, PASSWORD_IN);&lt;br/&gt;  COMMIT;&lt;br/&gt;  SELECT Accounts.ID INTO AccID FROM Accounts &lt;br/&gt;                WHERE UserName = USERNAME_IN;&lt;br/&gt;  INSERT INTO LockEvents (Accounts_ID) VALUES(AccID);&lt;br/&gt;  RESULT := 1;&lt;br/&gt;&lt;br/&gt;  Exception&lt;br/&gt;  WHEN ACCOUNT_EXISTS THEN&lt;br/&gt;    RESULT := 2;&lt;br/&gt;  WHEN OTHERS THEN&lt;br/&gt;    RESULT := 3;&lt;br/&gt;  NULL;&lt;br/&gt;END CREATEACCOUNT_SP;</body>
</StoredProcedureOraclev10g>